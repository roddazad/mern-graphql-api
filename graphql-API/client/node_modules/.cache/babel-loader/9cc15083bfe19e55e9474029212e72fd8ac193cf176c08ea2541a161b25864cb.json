{"ast":null,"code":"import _regeneratorRuntime from\"/Users/roddazad/bootcamp/myrepos/mern-graphql-api/graphql-API/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/roddazad/bootcamp/myrepos/mern-graphql-api/graphql-API/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/roddazad/bootcamp/myrepos/mern-graphql-api/graphql-API/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{Jumbotron,Container,CardColumns,Card,Button}from'react-bootstrap';import{useMutation}from'@apollo/client';import{GET_ME}from'../utils/queries';import{REMOVE_BOOK}from'../utils/mutations';// import { Navigate, useParams } from 'react-router-dom';\n// import { getMe, deleteBook } from '../utils/API';\nimport Auth from'../utils/auth';import{removeBookId}from'../utils/localStorage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SavedBooks=function SavedBooks(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];var _useMutation=useMutation(REMOVE_BOOK),_useMutation2=_slicedToArray(_useMutation,2),deleteBook=_useMutation2[0],_useMutation2$=_useMutation2[1],error=_useMutation2$.error,bookData=_useMutation2$.bookData;// const { userData: userParam } = useParams();\n// use this to determine if `useEffect()` hook needs to run again\nvar userDataLength=Object.keys(userData).length;// useEffect(() => {\n//   const getUserData = async () => {\n//     try {\n//       const token = Auth.loggedIn() ? Auth.getToken() : null;\n//       if (!token) {\n//         return false;\n//       }\n//       const response = await getMe(token);\n//       if (!response.ok) {\n//         throw new Error('something went wrong!');\n//       }\n//       const user = await response.json();\n//       setUserData(user);\n//     } catch (err) {\n//       console.error(err);\n//     }\n//   };\n//   getUserData();\n// }, [userDataLength]);\nvar _useQuery=useQuery(GET_ME,{variables:{userData:userData}}),loading=_useQuery.loading,data=_useQuery.data;var user=(data===null||data===void 0?void 0:data.me)||{};// create function that accepts the book's mongo _id value as param and deletes the book from the database\nvar handleDeleteBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(bookId){var token,response,updatedUser;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:token=Auth.loggedIn()?Auth.getToken():null;if(token){_context.next=3;break;}return _context.abrupt(\"return\",false);case 3:_context.prev=3;_context.next=6;return deleteBook(bookId,token);case 6:response=_context.sent;if(response.ok){_context.next=9;break;}throw new Error('something went wrong!');case 9:_context.next=11;return response.json();case 11:updatedUser=_context.sent;setUserData(updatedUser);// upon success, remove book's id from localStorage\nremoveBookId(bookId);_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](3);console.error(_context.t0);case 19:case\"end\":return _context.stop();}},_callee,null,[[3,16]]);}));return function handleDeleteBook(_x){return _ref.apply(this,arguments);};}();// if data isn't here yet, say so\nif(!userDataLength){return/*#__PURE__*/_jsx(\"h2\",{children:\"LOADING...\"});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Jumbotron,{fluid:true,className:\"text-light bg-dark\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"h1\",{children:\"Viewing saved books!\"})})}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:userData.savedBooks.length?\"Viewing \".concat(userData.savedBooks.length,\" saved \").concat(userData.savedBooks.length===1?'book':'books',\":\"):'You have no saved books!'}),/*#__PURE__*/_jsx(CardColumns,{children:userData.savedBooks.map(function(book){return/*#__PURE__*/_jsxs(Card,{border:\"dark\",children:[book.image?/*#__PURE__*/_jsx(Card.Img,{src:book.image,alt:\"The cover for \".concat(book.title),variant:\"top\"}):null,/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:book.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"small\",children:[\"Authors: \",book.authors]}),/*#__PURE__*/_jsx(Card.Text,{children:book.description}),/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:function onClick(){return handleDeleteBook(book.bookId);},children:\"Delete this Book!\"})]})]},book.bookId);})})]})]});};export default SavedBooks;","map":{"version":3,"names":["React","useState","useEffect","Jumbotron","Container","CardColumns","Card","Button","useMutation","GET_ME","REMOVE_BOOK","Auth","removeBookId","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SavedBooks","_useState","_useState2","_slicedToArray","userData","setUserData","_useMutation","_useMutation2","deleteBook","_useMutation2$","error","bookData","userDataLength","Object","keys","length","_useQuery","useQuery","variables","loading","data","user","me","handleDeleteBook","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","bookId","token","response","updatedUser","wrap","_callee$","_context","prev","next","loggedIn","getToken","abrupt","sent","ok","Error","json","t0","console","stop","_x","apply","arguments","children","fluid","className","savedBooks","concat","map","book","border","image","Img","src","alt","title","variant","Body","Title","authors","Text","description","onClick"],"sources":["/Users/roddazad/bootcamp/myrepos/mern-graphql-api/graphql-API/client/src/pages/SavedBooks.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Jumbotron, Container, CardColumns, Card, Button } from 'react-bootstrap';\nimport { useMutation } from '@apollo/client';\nimport { GET_ME } from '../utils/queries';\nimport { REMOVE_BOOK } from '../utils/mutations';\n// import { Navigate, useParams } from 'react-router-dom';\n// import { getMe, deleteBook } from '../utils/API';\nimport Auth from '../utils/auth';\nimport { removeBookId } from '../utils/localStorage';\n\nconst SavedBooks = () => {\n  const [userData, setUserData] = useState({});\n  const [deleteBook, { error, bookData }] = useMutation(REMOVE_BOOK);\n\n  // const { userData: userParam } = useParams();\n\n  // use this to determine if `useEffect()` hook needs to run again\n  const userDataLength = Object.keys(userData).length;\n\n  // useEffect(() => {\n  //   const getUserData = async () => {\n  //     try {\n  //       const token = Auth.loggedIn() ? Auth.getToken() : null;\n\n  //       if (!token) {\n  //         return false;\n  //       }\n\n  //       const response = await getMe(token);\n\n  //       if (!response.ok) {\n  //         throw new Error('something went wrong!');\n  //       }\n\n  //       const user = await response.json();\n  //       setUserData(user);\n  //     } catch (err) {\n  //       console.error(err);\n  //     }\n  //   };\n\n  //   getUserData();\n  // }, [userDataLength]);\n  const { loading, data } = useQuery(GET_ME, {\n    variables: { userData },\n  });\n  const user = data?.me || {};\n\n  // create function that accepts the book's mongo _id value as param and deletes the book from the database\n  const handleDeleteBook = async (bookId) => {\n    const token = Auth.loggedIn() ? Auth.getToken() : null;\n\n    if (!token) {\n      return false;\n    }\n\n    try {\n      const response = await deleteBook(bookId, token);\n\n      if (!response.ok) {\n        throw new Error('something went wrong!');\n      }\n\n      const updatedUser = await response.json();\n      setUserData(updatedUser);\n      // upon success, remove book's id from localStorage\n      removeBookId(bookId);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  // if data isn't here yet, say so\n  if (!userDataLength) {\n    return <h2>LOADING...</h2>;\n  }\n\n  return (\n    <>\n      <Jumbotron fluid className='text-light bg-dark'>\n        <Container>\n          <h1>Viewing saved books!</h1>\n        </Container>\n      </Jumbotron>\n      <Container>\n        <h2>\n          {userData.savedBooks.length\n            ? `Viewing ${userData.savedBooks.length} saved ${userData.savedBooks.length === 1 ? 'book' : 'books'}:`\n            : 'You have no saved books!'}\n        </h2>\n        <CardColumns>\n          {userData.savedBooks.map((book) => {\n            return (\n              <Card key={book.bookId} border='dark'>\n                {book.image ? <Card.Img src={book.image} alt={`The cover for ${book.title}`} variant='top' /> : null}\n                <Card.Body>\n                  <Card.Title>{book.title}</Card.Title>\n                  <p className='small'>Authors: {book.authors}</p>\n                  <Card.Text>{book.description}</Card.Text>\n                  <Button className='btn-block btn-danger' onClick={() => handleDeleteBook(book.bookId)}>\n                    Delete this Book!\n                  </Button>\n                </Card.Body>\n              </Card>\n            );\n          })}\n        </CardColumns>\n      </Container>\n    </>\n  );\n};\n\nexport default SavedBooks;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}